import nmap

# set up scanner object
scanner = nmap.PortScanner()

# intro
print("Simple nmap automation tool")
print("----------------------------")

# user input
ip_addr = input("Please enter the IP address , you want to scan: \n\t\t>")
print(f"The ip you entered is: {ip_addr}")

resp = input("""  \nPlease enter what type of scan you would like to run
                    1. SYN ACK Scan
                    2. UDP Scan
                    3. Comprehensive Scan
        >  """)
print(f"You chose option: {resp}")


# check user input

if resp == "1": #TCP
    print(f"\n TCP \nNmap Version: {scanner.nmap_version()}")
    scanner.scan(ip_addr , '1-1024' , '-v -sS' )
    print(scanner.scaninfo())
    print( f"IP Status:  { scanner[ip_addr].state() }" )
    print(scanner[ip_addr].all_protocols())
    if "tcp" in  scanner[ip_addr]:
        print(f"Open TCP Ports : { [ i for i in scanner[ip_addr]['tcp'].keys() ] }")
    else:
        print("Address has no open TCP ports")



elif resp == "2": #UDP
    print(f"\n UDP \nNmap Version: {scanner.nmap_version()}")
    scanner.scan(ip_addr , '1-1024' , '-v -sU' )
    print(scanner.scaninfo())
    print( f"IP Status:  { scanner[ip_addr].state() }" )
    print(scanner[ip_addr].all_protocols())
    if "udp" in  scanner[ip_addr]:
        print(f"Open UDP Ports : { [ i for i in scanner[ip_addr]['udp'].keys() ] }")
    else:
        print("Address has no open UDP ports")




elif resp == "3":
    print(f"\n Comprehensive TCP \nNmap Version: {scanner.nmap_version()}")
    scanner.scan(ip_addr , '1-1024' , '-v -sS -sV -sC -A -O' )
    print(scanner.scaninfo())
    print( f"IP Status:  { scanner[ip_addr].state() }" )
    print(scanner[ip_addr].all_protocols())
    if "tcp" in  scanner[ip_addr]:
        print(f"Open TCP Ports : { [ i for i in scanner[ip_addr]['tcp'].keys() ] }")
    else:
        print("Address has no open TCP ports")


# error handling
else:
    print("invalid response")
    exit()